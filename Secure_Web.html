<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Web App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .animate-gradient {
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        .security-indicator {
            transition: all 0.3s ease;
        }
        input:focus {
            outline: 2px solid #60a5fa;
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(96,165,250,0.2);
        }
        .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: all 0.3s ease;
            transform: translateY(5px);
        }
        .has-tooltip:hover .tooltip {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }
        .password-strength {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-50 to-blue-50 animate-gradient">
    <div class="container mx-auto px-4 py-8">
        <!-- Security Header Bar -->
        <div class="flex justify-between items-center mb-8 bg-white/80 shadow-lg backdrop-blur-sm rounded-xl p-4 transition-all hover:shadow-xl hover:scale-[1.01]">
            <h1 class="text-2xl font-bold text-gray-800">Secure Web App</h1>
            <div class="flex items-center space-x-4">
                <div class="security-indicator bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium flex items-center">
                    <span id="connection-status" class="mr-1">üîí HTTPS</span>
                    <div class="has-tooltip relative">
                        <span class="text-gray-500">‚ÑπÔ∏è</span>
                        <div class="tooltip absolute top-full left-0 mt-1 w-48 bg-white shadow-lg rounded-lg p-2 text-xs text-gray-700 z-10">
                            All connections encrypted with TLS 1.3
                        </div>
                    </div>
                </div>
                <button id="logout-btn" class="hidden bg-red-500 hover:bg-red-600 text-white px-4 py-1 rounded-full text-sm">Logout</button>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="grid md:grid-cols-4 gap-6">
            <!-- Auth Sidebar -->
            <div id="auth-section" class="bg-white/90 p-6 rounded-xl shadow-lg backdrop-blur-sm border border-blue-100/50 md:col-span-1 hover:shadow-xl transition-all">
                <h2 class="text-xl font-semibold mb-4 text-gray-800">Authentication</h2>
                
                <div id="login-form">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-1" for="email">Email</label>
                        <input type="email" id="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="user@example.com">
                        <p class="text-xs text-gray-500 mt-1">We'll never share your email.</p>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-1" for="password">Password</label>
                        <input type="password" id="password" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        <div class="flex items-center mt-1">
                            <div class="password-strength h-1 w-full bg-gray-200 rounded-full mr-2">
                                <div id="strength-meter" class="h-1 rounded-full w-0"></div>
                            </div>
                            <span id="strength-text" class="text-xs text-gray-500">Weak</span>
                        </div>
                    </div>
                    <button id="login-btn" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-3 px-6 rounded-lg mb-4 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200 font-medium">Login</button>
                    <div class="text-center">
                        <button id="show-register" class="text-blue-600 text-sm hover:text-blue-800">Create Account</button>
                    </div>
                </div>

                <div id="register-form" class="hidden">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-1" for="reg-name">Full Name</label>
                        <input type="text" id="reg-name" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-1" for="reg-email">Email</label>
                        <input type="email" id="reg-email" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-1" for="reg-password">Password</label>
                        <input type="password" id="reg-password" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        <ul class="text-xs text-gray-500 mt-1 pl-4 list-disc">
                            <li>Minimum 8 characters</li>
                            <li>At least 1 number</li>
                            <li>At least 1 special character</li>
                        </ul>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-1" for="reg-confirm">Confirm Password</label>
                        <input type="password" id="reg-confirm" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                    </div>
                    <button id="register-btn" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md mb-4">Register</button>
                    <div class="text-center">
                        <button id="show-login" class="text-blue-600 text-sm hover:text-blue-800">Already have an account?</button>
                    </div>
                </div>
            </div>

            <!-- Protected Content -->
            <div id="protected-content" class="hidden md:col-span-3">
                <div class="bg-white p-6 rounded-lg shadow-md mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">Dashboard</h2>
                        <span id="user-role" class="bg-purple-100 text-purple-800 text-xs px-3 py-1 rounded-full">User</span>
                    </div>
                    <div class="space-y-4">
                        <div class="animate-pulse flex space-x-4">
                            <div class="flex-1 space-y-4 py-1">
                                <div class="h-4 bg-gray-200 rounded w-3/4"></div>
                                <div class="space-y-2">
                                    <div class="h-4 bg-gray-200 rounded"></div>
                                    <div class="h-4 bg-gray-200 rounded w-5/6"></div>
                                </div>
                            </div>
                        </div>
                        <div class="text-center py-8" id="loading-message">
                            <p class="text-gray-500">Loading secure content...</p>
                        </div>
                    </div>
                </div>

                <!-- Data Section -->
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Secure Data Form -->
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-medium mb-4 text-gray-800">Secure Data Input</h3>
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-medium mb-1" for="secure-data">Enter Sensitive Data</label>
                            <textarea id="secure-data" class="w-full px-3 py-2 border border-gray-300 rounded-md" rows="3" placeholder="Never store plaintext passwords!"></textarea>
                            <p class="text-xs text-gray-500 mt-1">This demonstrates proper parameterized queries.</p>
                        </div>
                        <button id="save-data" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md">Save Securely</button>
                        
                        <div class="mt-4 p-3 bg-yellow-50 rounded-md hidden" id="sql-warning">
                            <p class="text-sm text-yellow-800">Warning: Potential SQL injection detected! We've prevented this action.</p>
                        </div>
                    </div>

                    <!-- Authorization Demo -->
                    <div id="admin-section" class="bg-white p-6 rounded-lg shadow-md hidden">
                        <h3 class="text-lg font-medium mb-4 text-gray-800">Admin Controls</h3>
                        <p class="text-sm text-gray-600 mb-4">This section is only visible to admin users, demonstrating authorization.</p>
                        <button id="admin-action" class="bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-md">Perform Admin Action</button>
                    </div>
                </div>
            </div>

            <!-- Security Tips -->
            <div id="security-tips" class="bg-white/90 p-6 rounded-xl shadow-lg backdrop-blur-sm border border-blue-100/50 md:col-span-3 hover:shadow-xl transition-all">
                <h2 class="text-xl font-semibold mb-4 text-gray-800">Security Features Implemented</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="p-4 border-2 border-green-200 rounded-xl bg-green-50/80 hover:bg-green-100/60 transition-all hover:shadow-md hover:-translate-y-1">
                        <h3 class="font-medium text-green-800 mb-2">‚úì Authentication</h3>
                        <ul class="text-xs text-green-700 space-y-1">
                            <li>JWT token storage in HttpOnly cookies</li>
                            <li>Password hashing with bcrypt (simulated)</li>
                            <li>Secure session management</li>
                        </ul>
                    </div>
                    <div class="p-4 border border-blue-200 rounded-lg bg-blue-50">
                        <h3 class="font-medium text-blue-800 mb-2">‚úì Authorization</h3>
                        <ul class="text-xs text-blue-700 space-y-1">
                            <li>Role-based access control</li>
                            <li>Protected routes</li>
                            <li>JWT claims validation</li>
                        </ul>
                    </div>
                    <div class="p-4 border border-purple-200 rounded-lg bg-purple-50">
                        <h3 class="font-medium text-purple-800 mb-2">‚úì Data Security</h3>
                        <ul class="text-xs text-purple-700 space-y-1">
                            <li>SQL injection prevention</li>
                            <li>Secure data transmission</li>
                            <li>Input sanitization</li>
                        </ul>
                    </div>
                    <div class="p-4 border border-yellow-200 rounded-lg bg-yellow-50">
                        <h3 class="font-medium text-yellow-800 mb-2">‚úì OWASP Top 10</h3>
                        <ul class="text-xs text-yellow-700 space-y-1">
                            <li>Injection protection</li>
                            <li>Broken authentication prevention</li>
                            <li>Sensitive data exposure mitigation</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simulated database of users
        const users = [];
        const sessions = {};
        
        // JWT secret (in production, this should be a complex, environment variable)
        const JWT_SECRET = 'supersecretkey';
        
        // DOM Elements
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const showRegister = document.getElementById('show-register');
        const showLogin = document.getElementById('show-login');
        const loginBtn = document.getElementById('login-btn');
        const registerBtn = document.getElementById('register-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const protectedContent = document.getElementById('protected-content');
        const securityTips = document.getElementById('security-tips');
        const adminSection = document.getElementById('admin-section');
        const sqlWarning = document.getElementById('sql-warning');
        const saveDataBtn = document.getElementById('save-data');
        const adminActionBtn = document.getElementById('admin-action');
        
        // Password strength indicator
        const passwordInput = document.getElementById('password');
        const strengthMeter = document.getElementById('strength-meter');
        const strengthText = document.getElementById('strength-text');
        
        // Event Listeners
        showRegister.addEventListener('click', () => {
            loginForm.classList.add('hidden');
            registerForm.classList.remove('hidden');
        });
        
        showLogin.addEventListener('click', () => {
            registerForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
        });
        
        passwordInput.addEventListener('input', updatePasswordStrength);
        
        loginBtn.addEventListener('click', handleLogin);
        registerBtn.addEventListener('click', handleRegister);
        logoutBtn.addEventListener('click', handleLogout);
        saveDataBtn.addEventListener('click', handleDataSave);
        adminActionBtn.addEventListener('click', handleAdminAction);
        
        // Password Strength Checker
        function updatePasswordStrength() {
            const password = passwordInput.value;
            let strength = 0;
            
            // Length check
            if (password.length >= 8) strength += 1;
            if (password.length >= 12) strength += 1;
            
            // Complexity checks
            if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength += 1;
            if (password.match(/\d/)) strength += 1;
            if (password.match(/[^a-zA-Z0-9]/)) strength += 1;
            
            // Update UI
            const widths = ['0%', '20%', '40%', '60%', '80%', '100%'];
            const colors = ['bg-red-500', 'bg-orange-500', 'bg-yellow-500', 'bg-green-500', 'bg-green-600'];
            const texts = ['Very Weak', 'Weak', 'Medium', 'Strong', 'Very Strong'];
            
            strengthMeter.style.width = widths[strength];
            strengthMeter.className = `h-1 rounded-full ${colors[strength]}`;
            strengthText.textContent = texts[strength] || '';
            strengthText.className = `text-xs ${
                strength < 2 ? 'text-red-500' : 
                strength < 4 ? 'text-yellow-500' : 'text-green-500'
            }`;
        }
        
        // Simulated BCrypt Hashing
        async function hashPassword(password) {
            // In a real app, you would use: return await bcrypt.hash(password, 10);
            return Promise.resolve(`hashed_${password}`);
        }
        
        async function verifyPassword(password, hashedPassword) {
            // In a real app, you would use: return await bcrypt.compare(password, hashedPassword);
            return Promise.resolve(hashedPassword === `hashed_${password}`);
        }
        
        // Generate JWT Token
        function generateToken(user) {
            const header = {
                alg: 'HS256',
                typ: 'JWT'
            };
            
            const payload = {
                userId: user.id,
                email: user.email,
                role: user.role || 'user',
                exp: Math.floor(Date.now() / 1000) + (60 * 60) // 1 hour expiration
            };
            
            // In a real app, you would properly sign the token
            const encodedHeader = btoa(JSON.stringify(header));
            const encodedPayload = btoa(JSON.stringify(payload));
            
            return `${encodedHeader}.${encodedPayload}.${JWT_SECRET}`;
        }
        
        // Verify JWT Token
        function verifyToken(token) {
            try {
                const parts = token.split('.');
                if (parts.length !== 3) return null;
                
                const payload = JSON.parse(atob(parts[1]));
                
                // Check expiration
                if (payload.exp && payload.exp < Math.floor(Date.now() / 1000)) {
                    return null;
                }
                
                return payload;
            } catch (e) {
                return null;
            }
        }
        
        // Check for SQL Injection
        function isSqlInjection(text) {
            const sqlKeywords = ['select', 'insert', 'update', 'delete', 'drop', 'union', '--', ';'];
            return sqlKeywords.some(keyword => 
                text.toLowerCase().includes(keyword)
            );
        }
        
        // Login Handler
        async function handleLogin() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Basic validation
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }
            
            // Find user
            const user = users.find(u => u.email === email);
            if (!user) {
                alert('User not found');
                return;
            }
            
            // Verify password
            const isMatch = await verifyPassword(password, user.password);
            if (!isMatch) {
                alert('Invalid credentials');
                return;
            }
            
            // Generate token
            const token = generateToken(user);
            
            // Store token (in real app, would be HttpOnly cookie)
            localStorage.setItem('jwt_token', token);
            
            // Update UI
            loginForm.classList.add('hidden');
            registerForm.classList.add('hidden');
            logoutBtn.classList.remove('hidden');
            protectedContent.classList.remove('hidden');
            securityTips.classList.add('hidden');
            
            // Set user role
            document.getElementById('user-role').textContent = user.role || 'user';
            document.getElementById('user-role').className = 
                user.role === 'admin' ? 
                'bg-purple-100 text-purple-800 text-xs px-3 py-1 rounded-full' :
                'bg-blue-100 text-blue-800 text-xs px-3 py-1 rounded-full';
                
            // Show admin section if admin
            if (user.role === 'admin') {
                adminSection.classList.remove('hidden');
            }
            
            // Simulate loading protected data
            setTimeout(() => {
                document.getElementById('loading-message').textContent = 'Secure content loaded!';
            }, 1500);
        }
        
        // Registration Handler
        async function handleRegister() {
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            const confirm = document.getElementById('reg-confirm').value;
            
            // Validation
            if (!name || !email || !password || !confirm) {
                alert('Please fill in all fields');
                return;
            }
            
            if (password !== confirm) {
                alert('Passwords do not match');
                return;
            }
            
            if (password.length < 8) {
                alert('Password must be at least 8 characters');
                return;
            }
            
            // Check if user exists
            if (users.some(u => u.email === email)) {
                alert('User already exists');
                return;
            }
            
            // Hash password
            const hashedPassword = await hashPassword(password);
            
            // Create user (in real app, this would be saved to database)
            const newUser = {
                id: Date.now().toString(),
                name,
                email,
                password: hashedPassword,
                role: email.endsWith('@admin.com') ? 'admin' : 'user'
            };
            
            users.push(newUser);
            
            // Show success and switch to login
            alert('Registration successful! Please login.');
            registerForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
            
            // Pre-fill email
            document.getElementById('email').value = email;
        }
        
        // Logout Handler
        function handleLogout() {
            // Clear token
            localStorage.removeItem('jwt_token');
            
            // Reset UI
            logoutBtn.classList.add('hidden');
            protectedContent.classList.add('hidden');
            adminSection.classList.add('hidden');
            securityTips.classList.remove('hidden');
            loginForm.classList.remove('hidden');
            
            // Clear form fields
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
            
            // Reset status messages
            document.getElementById('loading-message').textContent = 'Loading secure content...';
        }
        
        // Protected Data Handler
        function handleDataSave() {
            const data = document.getElementById('secure-data').value;
            
            // Check for SQL injection
            if (isSqlInjection(data)) {
                sqlWarning.classList.remove('hidden');
                return;
            } else {
                sqlWarning.classList.add('hidden');
            }
            
            // Simulate secure save
            alert(`Data saved securely: "${data}"`);
            
            // Clear the form
            document.getElementById('secure-data').value = '';
        }
        
        // Admin Action Handler
        function handleAdminAction() {
            alert('Admin action performed!\nThis demonstrates proper authorization checks.');
        }
        
        // Check for existing session on page load
        function checkAuth() {
            const token = localStorage.getItem('jwt_token');
            
            if (token) {
                const payload = verifyToken(token);
                
                if (payload) {
                    // User is authenticated
                    loginForm.classList.add('hidden');
                    registerForm.classList.add('hidden');
                    logoutBtn.classList.remove('hidden');
                    protectedContent.classList.remove('hidden');
                    securityTips.classList.add('hidden');
                    
                    // Set user role
                    document.getElementById('user-role').textContent = payload.role || 'user';
                    
                    // Show admin section if admin
                    if (payload.role === 'admin') {
                        adminSection.classList.remove('hidden');
                    }
                    
                    // Simulate content loaded
                    setTimeout(() => {
                        document.getElementById('loading-message').textContent = 'Secure content loaded!';
                    }, 500);
                } else {
                    // Invalid token, clear it
                    localStorage.removeItem('jwt_token');
                }
            }
        }
        
        // Initialize
        checkAuth();
    </script>
</body>
</html>
<script>
    // Tailwind CSS configuration for custom colors
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'blue-50': '#eff6ff',
                    'blue-100': '#dbeafe',
                    'blue-200': '#bfdbfe',
                    'blue-300': '#93c5fd',
                    'blue-400': '#60a5fa',
                    'blue-500': '#3b82f6',
                    'blue-600': '#2563eb',
                    'blue-700': '#1d4ed8',
                    'blue-800': '#1e40af',
                    'blue-900': '#1e3a8a'
                }
            }
        }
    };